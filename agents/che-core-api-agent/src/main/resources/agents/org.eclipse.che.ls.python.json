{
"id": "org.eclipse.che.ls.python",
"name": "Python language server",
"description": "Python intellisense",
"dependencies": [],
"properties": {},
"script" : "#\n# Copyright (c) 2012-2017 Codenvy, S.A.\n# All rights reserved. This program and the accompanying materials\n# are made available under the terms of the Eclipse Public License v1.0\n# which accompanies this distribution, and is available at\n# http://www.eclipse.org/legal/epl-v10.html\n#\n# Contributors:\n# Codenvy, S.A. - initial API and implementation\n#\n\nunset PACKAGES\nunset SUDO\ncommand -v tar >/dev/null 2>&1 || { PACKAGES=${PACKAGES}\" tar\"; }\ncommand -v curl >/dev/null 2>&1 || { PACKAGES=${PACKAGES}\" curl\"; }\ntest \"$(id -u)\" = 0 || SUDO=\"sudo\"\n\nAGENT_BINARIES_URI=https://codenvy.com/update/repository/public/download/org.eclipse.che.ls.python.binaries\nCHE_DIR=$HOME/che\nLS_DIR=${CHE_DIR}/ls-python\nLS_LAUNCHER=${LS_DIR}/launch.sh\n\nif [ -f /etc/centos-release ]; then\n FILE=\"/etc/centos-release\"\n LINUX_TYPE=$(cat $FILE | awk '{print $1}')\n elif [ -f /etc/redhat-release ]; then\n FILE=\"/etc/redhat-release\"\n LINUX_TYPE=$(cat $FILE | cut -c 1-8)\n else\n FILE=\"/etc/os-release\"\n LINUX_TYPE=$(cat $FILE | grep ^ID= | tr '[:upper:]' '[:lower:]')\n LINUX_VERSION=$(cat $FILE | grep ^VERSION_ID=)\nfi\n\nMACHINE_TYPE=$(uname -m)\n\nmkdir -p ${CHE_DIR}\nmkdir -p ${LS_DIR}\n\n########################\n### Install packages ###\n########################\n\n# Red Hat Enterprise Linux 7\n############################\nif echo ${LINUX_TYPE} | grep -qi \"rhel\"; then\n test \"${PACKAGES}\" = \"\" || {\n ${SUDO} yum install ${PACKAGES};\n }\n\n command -v python3.5 >/dev/null 2>&1 || {\n ${SUDO} yum-config-manager --enable rhel-server-rhscl-7-rpms;\n ${SUDO} yum -y install rh-python35 bzip2;\n export LD_LIBRARY_PATH=\"/opt/rh/rh-python35/root/usr/lib64\"\n export PATH=\"/opt/rh/rh-python35/root/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\n echo \"export LD_LIBRARY_PATH=/opt/rh/rh-python35/root/usr/lib64\" >> $HOME/.bashrc\n echo \"export PATH=/opt/rh/rh-python35/root/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" >> $HOME/.bashrc\n }\n\n# Red Hat Enterprise Linux 6\n############################\nelif echo ${LINUX_TYPE} | grep -qi \"Red Hat\"; then\n test \"${PACKAGES}\" = \"\" || {\n ${SUDO} yum install ${PACKAGES};\n }\n\n command -v python3.5 >/dev/null 2>&1 || {\n ${SUDO} yum-config-manager --enable rhel-server-rhscl-7-rpms;\n ${SUDO} yum -y install rh-python35 bzip2;\n export LD_LIBRARY_PATH=\"/opt/rh/rh-python35/root/usr/lib64\"\n export PATH=\"/opt/rh/rh-python35/root/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\n echo \"export LD_LIBRARY_PATH=/opt/rh/rh-python35/root/usr/lib64\" >> $HOME/.bashrc\n echo \"export PATH=/opt/rh/rh-python35/root/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" >> $HOME/.bashrc\n }\n\n\n# Ubuntu 14.04 16.04 / Linux Mint 17\n####################################\nelif echo ${LINUX_TYPE} | grep -qi \"ubuntu\"; then\n test \"${PACKAGES}\" = \"\" || {\n ${SUDO} apt-get update;\n ${SUDO} apt-get -y install ${PACKAGES};\n }\n\n command -v python3.5 >/dev/null 2>&1 || {\n if echo ${LINUX_VERSION} | grep -qi \"14.04\"; then\n DEADSNAKES=\"/etc/apt/sources.list.d/deadsnakes.list\";\n ${SUDO} touch ${DEADSNAKES};\n echo \"deb http://ppa.launchpad.net/fkrull/deadsnakes/ubuntu trusty main\" | ${SUDO} tee --append ${DEADSNAKES};\n echo \"deb-src http://ppa.launchpad.net/fkrull/deadsnakes/ubuntu trusty main\" | ${SUDO} tee --append ${DEADSNAKES};\n ${SUDO} gpg --keyserver keyserver.ubuntu.com --recv-keys DB82666C;\n ${SUDO} gpg --export DB82666C | ${SUDO} apt-key add -;\n\n ${SUDO} apt-get update;\n ${SUDO} apt-get install -y python3.5 bzip2;\n ${SUDO} curl https://bootstrap.pypa.io/ez_setup.py -o - | ${SUDO} python3.5\n ${SUDO} easy_install pip\n else\n ${SUDO} apt-get update;\n ${SUDO} apt-get install -y python3.5;\n ${SUDO} apt-get install -y python3-pip;\n fi\n }\n\n\n# Debian 8\n##########\nelif echo ${LINUX_TYPE} | grep -qi \"debian\"; then\n test \"${PACKAGES}\" = \"\" || {\n ${SUDO} apt-get update;\n ${SUDO} apt-get -y install ${PACKAGES};\n }\n\n command -v python3.5 >/dev/null 2>&1 || {\n DEADSNAKES=\"/etc/apt/sources.list.d/deadsnakes.list\";\n ${SUDO} touch ${DEADSNAKES};\n echo \"deb http://ppa.launchpad.net/fkrull/deadsnakes/ubuntu trusty main\" | ${SUDO} tee --append ${DEADSNAKES};\n echo \"deb-src http://ppa.launchpad.net/fkrull/deadsnakes/ubuntu trusty main\" | ${SUDO} tee --append ${DEADSNAKES};\n ${SUDO} gpg --keyserver keyserver.ubuntu.com --recv-keys DB82666C;\n ${SUDO} gpg --export DB82666C | ${SUDO} apt-key add -;\n\n ${SUDO} apt-get update;\n ${SUDO} apt-get install -y python3.5 bzip2;\n ${SUDO} curl https://bootstrap.pypa.io/ez_setup.py -o - | ${SUDO} python3.5\n ${SUDO} easy_install pip\n }\n\n# Fedora 23\n###########\nelif echo ${LINUX_TYPE} | grep -qi \"fedora\"; then\n PACKAGES=${PACKAGES}\" procps-ng\"\n test \"${PACKAGES}\" = \"\" || {\n ${SUDO} dnf -y install ${PACKAGES};\n }\n\n command -v python3.5 >/dev/null 2>&1 || {\n ${SUDO} dnf -y install python35 bzip2;\n ${SUDO} curl https://bootstrap.pypa.io/ez_setup.py -o - | ${SUDO} python3.5\n ${SUDO} easy_install pip\n }\n\n\n# CentOS 7.1 & Oracle Linux 7.1\n###############################\nelif echo ${LINUX_TYPE} | grep -qi \"centos\"; then\n test \"${PACKAGES}\" = \"\" || {\n ${SUDO} yum -y install ${PACKAGES};\n }\n\n command -v python3.5 >/dev/null 2>&1 || {\n\n ${SUDO} yum -y install centos-release-scl;\n ${SUDO} yum -y install rh-python35 bzip2;\n export LD_LIBRARY_PATH=\"/opt/rh/rh-python35/root/usr/lib64\"\n export PATH=\"/opt/rh/rh-python35/root/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\n echo \"export LD_LIBRARY_PATH=/opt/rh/rh-python35/root/usr/lib64\" >> $HOME/.bashrc\n echo \"export PATH=/opt/rh/rh-python35/root/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" >> $HOME/.bashrc\n }\n\n# openSUSE 13.2\n###############\nelif echo ${LINUX_TYPE} | grep -qi \"opensuse\"; then\n test \"${PACKAGES}\" = \"\" || {\n ${SUDO} zypper install -y ${PACKAGES};\n }\n\n command -v python3.5 >/dev/null 2>&1 || {\n ${SUDO} zypper ar -f http://download.opensuse.org/repositories/home:/Ledest:/bashisms/openSUSE_13.2/ home:Ledest:bashisms\n ${SUDO} zypper --no-gpg-checks ref\n ${SUDO} zypper install -y python3\n ${SUDO} zypper install -y python3-pip\n }\n\nelse\n >&2 echo \"Unrecognized Linux Type\"\n >&2 cat $FILE\n exit 1\nfi\n\n\n#########################\n### Install Python LS ###\n#########################\n\ncurl -s ${AGENT_BINARIES_URI} | tar xzf - -C ${LS_DIR}\n\ncd ${LS_DIR} && ${SUDO} pip3 install -r ${LS_DIR}/requirements.txt\n\ntouch ${LS_LAUNCHER}\nchmod +x ${LS_LAUNCHER}\necho \"python3.5 ${LS_DIR}/python-langserver.py --fs=local --mode=stdio\" > ${LS_LAUNCHER}"
}
